<div class="game-container">
  <!-- Header com mood -->
  <header class="game-header">
    <h1>ğŸµ Music Guess</h1>
    <div class="mood-section" *ngIf="currentMood() as mood">
      <div class="mood-display" [style.background-color]="mood.color">
        <div class="mood-emoji">{{ mood.emoji }}</div>
        <div class="mood-info">
          <h2>{{ mood.name }}</h2>
          <p>{{ mood.description }}</p>
        </div>
      </div>
    </div>
  </header>

  <!-- SeÃ§Ã£o principal do jogo -->
  <main class="game-main">
    <!-- Se jÃ¡ jogou hoje, mostrar resultado -->
    <div *ngIf="hasPlayedToday()" class="result-section">
      <h3>Sua tentativa de hoje</h3>
      <div class="result-card">
        <div class="result-music">
          <p class="label">Sua mÃºsica:</p>
          <p class="value">{{ currentScore()?.userGuess }}</p>
        </div>
        <div class="result-percentage">
          <p class="label">CorrespondÃªncia:</p>
          <div class="percentage-display">
            <span class="value">{{ currentScore()?.matchPercentage }}%</span>
            <div class="progress-bar">
              <div class="progress-fill" [style.width]="currentScore()?.matchPercentage + '%'"></div>
            </div>
          </div>
        </div>
        <div class="result-feedback">
          <p>{{ feedbackMessage() }}</p>
        </div>
      </div>
      <p class="locked-message">
        âœ¨ VocÃª jÃ¡ jogou sua tentativa de hoje. Volte amanhÃ£ para tentar novamente!
      </p>
    </div>

    <!-- Se ainda nÃ£o jogou, mostrar formulÃ¡rio -->
    <div *ngIf="!hasPlayedToday()" class="guess-section">
      <form (ngSubmit)="onSubmitGuess()">
        <div class="form-group">
          <label for="artistInput">Artista ğŸ¤</label>
          <input
            id="artistInput"
            type="text"
            [ngModel]="artistInput()"
            (ngModelChange)="artistInput.set($event)"
            name="artist"
            placeholder="Digite o nome do artista..."
            [disabled]="isSubmitting()"
            class="music-input"
          />
        </div>

        <div class="form-group">
          <label for="musicInput">MÃºsica ğŸµ</label>
          <input
            id="musicInput"
            type="text"
            [ngModel]="musicInput()"
            (ngModelChange)="musicInput.set($event)"
            name="music"
            placeholder="Digite o nome da mÃºsica..."
            [disabled]="isSubmitting()"
            class="music-input"
          />
        </div>

        <button
          type="submit"
          [disabled]="!artistInput().trim() || !musicInput().trim() || isSubmitting()"
          class="submit-btn"
        >
          <span *ngIf="!isSubmitting()">âœ¨ Enviar AdivinhaÃ§Ã£o</span>
          <span *ngIf="isSubmitting()">â³ Processando...</span>
        </button>
      </form>

      <!-- Mostrar resultado da tentativa enquanto estÃ¡ processando -->
      <div *ngIf="showResult()" class="guess-result">
        <h3>Resultado da sua tentativa!</h3>
        <div class="result-card">
          <div class="result-music">
            <p class="label">Sua mÃºsica:</p>
            <p class="value">{{ resultData()?.userGuess }}</p>
          </div>
          <div class="result-percentage">
            <p class="label">CorrespondÃªncia:</p>
            <div class="percentage-display">
              <span class="value">{{ resultData()?.matchPercentage }}%</span>
              <div class="progress-bar">
                <div class="progress-fill" [style.width]="resultData()?.matchPercentage + '%'"></div>
              </div>
            </div>
          </div>
          <div class="result-feedback">
            <p>{{ feedbackMessage() }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Mensagens de erro -->
    <div *ngIf="error()" class="error-message">
      <p>{{ error() }}</p>
      <button (click)="gameStateService.clearError()" class="close-btn">âœ•</button>
    </div>
  </main>
</div>
